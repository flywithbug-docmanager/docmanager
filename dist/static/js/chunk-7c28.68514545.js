(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7c28"],{RsqA:function(t,e,r){"use strict";r.r(e);var n=r("ZAAW"),o=r("tWJv"),i=r("XV9m"),a={name:"appForm",props:{modelId:{type:Number,require:!0}},data:function(){return{dialog:!1,loading:!0,currentAppId:0,options:[],form:{startVersion:"",endVersion:"",appId:null},simpleAppList:[],appList:[],rules:{appId:[{required:!0,message:"必须选择所属应用",trigger:"blur"}]}}},created:function(){this.getSimpleAppList()},methods:{getSimpleAppList:function(){var t=this;0==this.simpleAppList.length&&Object(o.c)().then(function(e){e.list&&(t.simpleAppList=e.list),t.loading=!1})},formatDisabledSimpleAppList:function(){var t=this;if(0!==this.appList.length){var e=function(e){var r=t.simpleAppList[e];r.disabled=!1,t.appList.forEach(function(t){r.id!==t.app.id||(r.disabled=!0)})};for(var r in this.simpleAppList)e(r)}},resetForm:function(){this.form.appId=null,this.form.endVersion="",this.form.startVersion=""},doneAction:function(){var t=this;this.$refs.form.validate(function(e){if(e){if(t.form.startVersion&&t.form.endVersion&&t.form.startVersion>t.form.endVersion)return void t.$message.error("开始版本不能大于结束版本");t.doSubmit()}})},doSubmit:function(){var t=this,e={app_id:this.form.appId,model_id:this.modelId};this.form.startVersion&&(e.start_Version=this.form.startVersion),this.form.endVersion&&(e.end_Version=this.form.endVersion),Object(n.a)(e).then(function(){t.$notify({title:"添加成功",type:"success",duration:1500}),t.resetForm(),t.$emit("refreshList")}),this.dialog=!1},selectorChanged:function(){this.currentAppId=this.form.appId,this.options=[]},queryAppVersion:function(t){var e=this;if(console.log("queryAppVersion"),0!=this.currentAppId){var r={app_id:this.currentAppId,version:t,size:5,sort:"+id"};Object(i.e)(r).then(function(t){e.options=t.list})}}}},s=(r("wAJT"),r("KHd+")),l=Object(s.a)(a,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{loading:t.loading,"append-to-body":!0,visible:t.dialog,title:"添加应用",width:"400px"},on:{"update:visible":function(e){t.dialog=e}}},[r("el-form",{ref:"form",attrs:{model:t.form,"label-width":"90px",rules:t.rules}},[r("el-form-item",{attrs:{label:"应用名称",prop:"appId"}},[r("el-select",{staticClass:"filter-item",attrs:{filterable:"",clearable:"",placeholder:"选择应用"},on:{change:t.selectorChanged},model:{value:t.form.appId,callback:function(e){t.$set(t.form,"appId",e)},expression:"form.appId"}},t._l(t.simpleAppList,function(t){return r("el-option",{key:t.key,attrs:{label:t.name,disabled:t.disabled,value:t.id}})}))],1),t._v(" "),r("el-form-item",{attrs:{label:"起始版本",prop:"startVersion"}},[r("el-select",{staticStyle:{"margin-top":"5px"},attrs:{"remote-method":t.queryAppVersion,loading:t.loading,remote:"",disabled:null===t.form.appId,clearable:"",filterable:"",placeholder:"请输入版本号关键字"},model:{value:t.form.startVersion,callback:function(e){t.$set(t.form,"startVersion",e)},expression:"form.startVersion"}},t._l(t.options,function(t){return r("el-option",{key:t.version,attrs:{label:t.version,value:t.version}})}))],1),t._v(" "),r("el-form-item",{attrs:{label:"结束版本",prop:"endVersion"}},[r("el-select",{staticStyle:{"margin-top":"5px"},attrs:{"remote-method":t.queryAppVersion,loading:t.loading,remote:"",disabled:null===t.form.appId,clearable:"",filterable:"",placeholder:"请输入版本号关键字"},model:{value:t.form.endVersion,callback:function(e){t.$set(t.form,"endVersion",e)},expression:"form.endVersion"}},t._l(t.options,function(t){return r("el-option",{key:t.version,attrs:{label:t.version,value:t.version}})}))],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"text"},on:{click:function(e){t.dialog=!1}}},[t._v("取消")]),t._v(" "),r("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.doneAction}},[t._v("确认")])],1)],1)},[],!1,null,"1dbb592d",null);l.options.__file="appForm.vue";e.default=l.exports},UfwC:function(t,e,r){},XV9m:function(t,e,r){"use strict";r.d(e,"e",function(){return o}),r.d(e,"a",function(){return i}),r.d(e,"c",function(){return a}),r.d(e,"b",function(){return s}),r.d(e,"d",function(){return l});var n=r("bNJ/");function o(t){return Object(n.a)({url:"/app/version/list",method:"get",params:t})}function i(t,e,r,o,i,a,s){var l={app_id:t,version:e,parent_version:r,platform:o,approval_time:i,lock_time:a,gray_time:s};return Object(n.a)({url:"/app/version",method:"post",data:l})}function a(t){return Object(n.a)({url:"/app/version",method:"put",data:t})}function s(t){var e={id:t};return Object(n.a)({url:"/app/version",method:"delete",data:e})}function l(t,e){var r={id:t,status:e};return console.log("editStatus",r),Object(n.a)({url:"/app/version",method:"put",data:r})}},ZAAW:function(t,e,r){"use strict";r.d(e,"d",function(){return o}),r.d(e,"g",function(){return i}),r.d(e,"c",function(){return a}),r.d(e,"b",function(){return s}),r.d(e,"e",function(){return l}),r.d(e,"f",function(){return d}),r.d(e,"h",function(){return u}),r.d(e,"a",function(){return p});var n=r("bNJ/");function o(t){return Object(n.a)({url:"/tools/model?id="+t,method:"get"})}function i(t){return Object(n.a)({url:"/tools/model/list",method:"get",params:t})}function a(t){return Object(n.a)({url:"/tools/model",method:"put",data:t})}function s(t){return Object(n.a)({url:"/tools/model/attribute",method:"put",data:t})}function l(t){return Object(n.a)({url:"/tools/model_apps",method:"get",params:t})}function d(t){return Object(n.a)({url:"/tools/model_app/version",method:"put",data:t})}function u(t){return Object(n.a)({url:"/tools/model_app",method:"Delete",data:t})}function p(t){return Object(n.a)({url:"/tools/model_app",method:"POST",data:t})}},tWJv:function(t,e,r){"use strict";r.d(e,"a",function(){return o}),r.d(e,"b",function(){return i}),r.d(e,"c",function(){return a});var n=r("bNJ/");function o(t){var e={bundle_id:t.bundle_id,icon:t.icon,name:t.name,desc:t.desc,managers:t.managers};return Object(n.a)({url:"/app",method:"post",data:e})}function i(t){var e={icon:t.icon,name:t.name,desc:t.desc,id:t.id,managers:t.managers,owner_id:t.owner_id};return Object(n.a)({url:"/app",method:"put",data:e})}function a(){return Object(n.a)({url:"/app/list/simple",method:"get"})}},wAJT:function(t,e,r){"use strict";var n=r("UfwC");r.n(n).a}}]);